{include="header"}

{if="$fsc->agente"}
<script type="text/javascript" src="{$fsc->get_js_location('provincias.js')}"></script>
<script type="text/javascript">
    url_organizacion = '{$fsc->url()}&type=organizacion';
     $(document).ready(function () {
        $("#b_delete_agente").click(function (event) {
            event.preventDefault();
            if(confirm("¿Realmente desea eliminar el agente?"))
            {
                window.location.href = '{$fsc->ppage->url()}&delete={$fsc->agente->codagente}';
            }
        });
   });
</script>

<div class="container-fluid">
   <div class="row" style="margin-bottom: 10px;">
      <div class="col-xs-3">
         <div class="btn-group">
            <a class="btn btn-sm btn-default" href="index.php?page=admin_agentes">
               <span class="glyphicon glyphicon-arrow-left"></span>
               <span class="hidden-xs hidden-sm">&nbsp; Empleados</span>
            </a>
            <a class="btn btn-sm btn-default" href="{$fsc->url()}" title="Recargar la página">
               <span class="glyphicon glyphicon-refresh"></span>
            </a>
         </div>
      </div>
      <div class="col-xs-6 text-center">
         <h2 style="margin-top: 0px;">
            Editar empleado <small>{$fsc->agente->codagente}</small>
         </h2>
      </div>
      <div class="col-sm-3 col-xs-3 text-right">
          <a class="btn btn-sm btn-success" href="{$fsc->url()}&type=nuevo" title="Nuevo empleado">
            <span class="glyphicon glyphicon-plus"></span>
         </a>
         <!--
         <button class="btn btn-sm btn-success" data-toggle="modal" data-target="#nuevoEmpleadoModal" title="Nuevo empleado">
            <span class="glyphicon glyphicon-plus"></span>
         </button>
         !-->
         {if="$fsc->allow_delete"}
         <a href="#" id="b_delete_agente" class="btn btn-sm btn-danger">
            <span class="glyphicon glyphicon-trash"></span>
            <span class="hidden-xs hidden-sm">&nbsp; Eliminar</span>
         </a>
         {/if}
      </div>
   </div>
   <div class="row">
      <div class="col-sm-3 col-lg-2">
         <ul class="nav nav-pills nav-stacked" role="tablist">
            <li role="presentation" class="active">
               <a href="#general" aria-controls="general" role="tab" data-toggle="tab">
               <span class="glyphicon glyphicon-dashboard"></span> &nbsp; Datos generales
            </a>
            </li>
            {loop="$fsc->extensions"}
               {if="$value->type=='button'"}
               <li>
                  <a id="b_{$value->from}" href="index.php?page={$value->from}{$value->params}&codagente={$fsc->agente->codagente}">
                     {$value->text}
                  </a>
               </li>
               {elseif="$value->type=='tab'"}
               <li role="presentation">
                  <a href="#ext_{$key}" aria-controls="ext_{$key}" role="tab" data-toggle="tab">
                     {$value->text}
                  </a>
               </li>
               {/if}
            {/loop}
         </ul>
      </div>
      <div class="col-sm-9 col-lg-10">
         <div class="tab-content">
            <div role="tabpanel" class="tab-pane active" id="general">
                <form class="form" role="form" enctype="multipart/form-data" action="{$fsc->url()}" method="post">
                   <div class='panel {if="$fsc->agente->f_baja"}panel-danger{else}panel-primary{/if}' id='panel_generales'>
                      <div class="panel-heading">
                         <h3 class="panel-title">
                            {$fsc->agente->get_fullname()}
                            {if="$fsc->agente->f_baja"}
                            &nbsp; <span class="label label-default" title="El empleado ha sido dado de baja">Baja</span>
                            {/if}
                         </h3>
                      </div>
                      <div class="panel-body">
                          <fieldset>
                              <legend>Datos Básicos:</legend>
                                <div class="col-sm-2" align="center">
                                    <div class="form-group">
                                        <img id="imagen-empleado" width="auto" height="120" src="{if="$fsc->agente->foto!=''"}{$fsc->agente->get_foto()}{else}{$fsc->noimagen}{/if}" alt="{$fsc->agente->nombreap}" class="img-circle">
                                    </div>
                                    <br/>
                                    <div class="form-group" align="center">
                                        <label class="btn btn-default btn-xs btn-file image-input">
                                           Cambiar <input type="file" style="display: none;" accept="image/png, image/jpeg" name="foto">
                                        </label>
                                    </div>
                                </div>
                               <div class="col-sm-2">
                                  <div class="form-group">
                                     <label class="label label-default" for="nombre">Nombre:</label>
                                     <input class="form-control input-sm" type="text" name="nombre" value="{$fsc->agente->nombre}" autocomplete="off"/>
                                  </div>
                               </div>
                               <div class="col-sm-3">
                                  <div class="form-group">
                                     <label class="label label-sm label-default" for="apellidos">Primer Apellido:</label>
                                     <input class="form-control input-sm" type="text" name="apellidos" value="{$fsc->agente->apellidos}" autocomplete="off"/>
                                  </div>
                               </div>
                               <div class="col-sm-3">
                                  <div class="form-group">
                                     <label class="label label-sm label-default" for="segundo_apellido">Segundo Apellido:</label>
                                     <input class="form-control input-sm" type="text" name="segundo_apellido" value="{$fsc->agente->segundo_apellido}" autocomplete="off"/>
                                  </div>
                               </div>
                               <div class="col-sm-2">
                                  <div class="form-group">
                                     <label class="label label-sm label-default" for="dnicif">{#FS_CIFNIF#}:</label>
                                     <input class="form-control input-sm" type="text" name="dnicif" value="{$fsc->agente->dnicif}" autocomplete="off"/>
                                  </div>
                               </div>
                               <div class="col-sm-2">
                                   <div class="form-group">
                                      <label class="label label-sm label-default">Fecha Nacimiento:</label>
                                      <div class="input-group">
                                         <span class="input-group-addon">
                                            <span class="glyphicon glyphicon-calendar"></span>
                                         </span>
                                         <input class="form-control datepicker input-sm" type="text" name="f_nacimiento" value="{$fsc->agente->f_nacimiento}" autocomplete="off"/>
                                      </div>
                                   </div>
                               </div>
                               <div class="col-sm-2">
                                  <div class="form-group">
                                     <span class="label label-sm label-default">Sexo:</span><br />
                                     <label><input class="radio-inline radio-control" type="radio" name="sexo" value="M" {if="$fsc->agente->sexo=='M'"}checked{/if}/> Masculino</label>
                                     <label><input class="radio-inline radio-control" type="radio" name="sexo" value="F" {if="$fsc->agente->sexo=='F'"}checked{/if}/> Femenino</label>
                                  </div>
                               </div>
                               <div class="col-sm-2">
                                  <div class="form-group">
                                     <label class="label label-sm label-default" for="estado_civil">Estado Civil:</label>
                                     <select name="estado_civil" required class="form-control input-sm">
                                         <option value="">--------</option>
                                         {loop="$fsc->agente->estado_civil_agente()"}
                                         <option value="{$key}" {if="$fsc->agente->estado_civil==$key"}selected{/if}>{$value}</option>
                                         {/loop}
                                     </select>
                                  </div>
                               </div>
                               <div class="col-sm-2">
                                  <div class="form-group">
                                     <label class="label label-sm label-default" for="telefono">Teléfono:</label>
                                     <input class="form-control input-sm" type="text" name="telefono" value="{$fsc->agente->telefono}" autocomplete="off"/>
                                  </div>
                               </div>
                               <div class="col-sm-2">
                                  <div class="form-group">
                                     <label class="label label-sm label-default" for="email">Email:</label>
                                     <input class="form-control input-sm" type="text" name="email" value="{$fsc->agente->email}" autocomplete="off"/>
                                  </div>
                               </div>
                               <div class="col-sm-3">
                                  <div class="form-group">
                                     <label class="label label-sm label-default" for="provincia">Provincia:</label>
                                     <input id="ac_provincia" class="form-control input-sm" type="text" name="provincia" value="{$fsc->agente->provincia}" autocomplete="off"/>
                                  </div>
                               </div>
                               <div class="col-sm-3">
                                  <div class="form-group">
                                     <label class="label label-sm label-default" for="ciudad">Ciudad:</label>
                                     <input class="form-control input-sm" type="text" name="ciudad" value="{$fsc->agente->ciudad}"/>
                                  </div>
                               </div>
                               <div class="col-sm-4">
                                  <div class="form-group">
                                     <label class="label label-sm label-default" for="direccion">Dirección:</label>
                                     <input class="form-control input-sm" type="text" name="direccion" value="{$fsc->agente->direccion}" autocomplete="off"/>
                                  </div>
                               </div>
                         </fieldset>
                         <fieldset>
                            <legend>Datos Organizacionales:</legend>
                                <div class="col-sm-2">
                                   <div class="form-group">
                                      <label class="label label-sm label-default" for="codalmacen">
                                          <a href="{$fsc->almacen->url()}">Almacén:</a>
                                      </label>
                                      <select name="codalmacen" required class="form-control input-sm">
                                          <option value="">--------</option>
                                          {loop="$fsc->almacen->all()"}
                                          <option value="{$value->codalmacen}" {if="$fsc->agente->codalmacen==$value->codalmacen"}selected{/if}>{$value->nombre}</option>
                                          {/loop}
                                      </select>
                                   </div>
                                </div>
                                <div class="col-sm-2">
                                   <div class="form-group">
                                      <label class="label label-sm label-default" for="codcargo">
                                          <a href="{$fsc->cargos->url()}">Cargo ocupado:</a>
                                      </label>
                                      <select name="codcargo" required class="form-control input-sm">
                                          <option value="">--------</option>
                                          {loop="$fsc->cargos->all()"}
                                          <option value="{$value->codcargo}" {if="$fsc->agente->codcargo==$value->codcargo"}selected{/if}>{$value->descripcion}</option>
                                          {/loop}
                                      </select>

                                   </div>
                                </div>
                                <div class="col-sm-2">
                                   <div class="form-group">
                                      <label class="label label-sm label-default" for="codcategoria">
                                          <a href="{$fsc->categoriaempleado->url()}">Categoria de empleado:</a>
                                      </label>
                                      <select name="codcategoria" required class="form-control input-sm">
                                          <option value="">--------</option>
                                          {loop="$fsc->categoriaempleado->all()"}
                                          <option value="{$value->codcategoria}" {if="$fsc->agente->codcategoria==$value->codcategoria"}selected{/if}>{$value->descripcion}</option>
                                          {/loop}
                                      </select>
                                   </div>
                                </div>
                                <div class="col-sm-3">
                                   <div class="form-group">
                                      <label class="label label-sm label-default" for="codsupervisor">
                                          Reporta a:
                                      </label>
                                      <select name="codsupervisor" class="form-control input-sm">
                                          <option value="">--------</option>
                                          {loop="$fsc->agente->all()"}
                                          <option value="{$value->codagente}" {if="$fsc->agente->codsupervisor==$value->codagente"}selected{/if}>{$value->nombreap}</option>
                                          {/loop}
                                      </select>
                                   </div>
                                </div>
                                <div class="col-sm-3">
                                   <div class="form-group">
                                      <label class="label label-sm label-default" for="codtipo">
                                          <a href="{$fsc->tipoempleado->url()}">Tipo de Contrato:</a>
                                      </label>
                                      <select name="codtipo" required class="form-control input-sm">
                                          <option value="">--------</option>
                                          {loop="$fsc->tipoempleado->all()"}
                                          <option value="{$value->codtipo}" {if="$fsc->agente->codtipo==$value->codtipo"}selected{/if}>{$value->descripcion}</option>
                                          {/loop}
                                      </select>
                                   </div>
                                </div>
                                <div class="col-sm-4">
                                   <div class="form-group">
                                      <label class="label label-sm label-default" for="codgerencia">
                                          <a href="{$fsc->organizacion->url()}">Gerencia:</a>
                                      </label>
                                      <select name="codgerencia" id="codgerencia" onchange="llenar_organizacion(this,'codgerencia','codarea')" required class="form-control input-sm">
                                          <option value="">--------</option>
                                          {loop="$fsc->organizacion->all_tipo('GERENCIA')"}
                                          <option value="{$value->codorganizacion}" {if="$fsc->agente->codgerencia==$value->codorganizacion"}selected{/if}>{$value->descripcion}</option>
                                          {/loop}
                                      </select>
                                   </div>
                                </div>
                                <div class="col-sm-4">
                                   <div class="form-group">
                                      <label class="label label-sm label-default" for="codarea">
                                          <a href="{$fsc->organizacion->url()}">Area:</a>
                                      </label>
                                      <select name="codarea" id="codarea" onchange="llenar_organizacion(this,'codarea','coddepartamento')" required class="form-control input-sm">
                                          <option value="">--------</option>
                                          {loop="$fsc->organizacion->all_tipo('AREA')"}
                                          <option value="{$value->codorganizacion}" {if="$fsc->agente->codarea==$value->codorganizacion"}selected{/if}>{$value->descripcion}</option>
                                          {/loop}
                                      </select>
                                   </div>
                                </div>
                                <div class="col-sm-4">
                                   <div class="form-group">
                                      <label class="label label-sm label-default" for="coddepartamento">
                                          <a href="{$fsc->organizacion->url()}">Departamento:</a>
                                      </label>
                                      <select name="coddepartamento" id="coddepartamento" required class="form-control input-sm">
                                          <option value="">--------</option>
                                          {loop="$fsc->organizacion->all_tipo('DEPARTAMENTO')"}
                                          <option value="{$value->codorganizacion}" {if="$fsc->agente->coddepartamento==$value->codorganizacion"}selected{/if}>{$value->descripcion}</option>
                                          {/loop}
                                      </select>
                                   </div>
                                </div>
                                <div class="col-sm-2">
                                   <div class="form-group">
                                      <label class="label label-sm label-default">Fecha Alta:</label>
                                      <div class="input-group">
                                         <span class="input-group-addon">
                                            <span class="glyphicon glyphicon-calendar"></span>
                                         </span>
                                         <input class="form-control datepicker input-sm" type="text" name="f_alta" value="{$fsc->agente->f_alta}" autocomplete="off"/>
                                      </div>
                                   </div>
                                </div>
                                <div class="col-sm-2">
                                   <div class="form-group">
                                      <label class="label label-sm label-default">Fecha Baja:</label>
                                      <div class="input-group">
                                         <span class="input-group-addon">
                                            <span class="glyphicon glyphicon-calendar"></span>
                                         </span>
                                         <input class="form-control datepicker input-sm" type="text" name="f_baja" value="{$fsc->agente->f_baja}" autocomplete="off"/>
                                      </div>
                                   </div>
                                </div>
                                <div class="col-sm-3">
                                   <div class="form-group">
                                      <label class="label label-sm label-default">Estado:</label>
                                      <select name="estado" required class="form-control input-sm">
                                          <option value="">--------</option>
                                          {loop="$fsc->agente->estados_agente()"}
                                          <option value="{$key}" {if="$fsc->agente->estado==$key"}selected{/if}>{$value}</option>
                                          {/loop}
                                      </select>
                                   </div>
                                </div>
                                <div class="col-sm-3">
                                   <div class="form-group">
                                      <label class="label label-sm label-default">
                                          <a href="{$fsc->sindicalizacion->url()}">Sindicalizado:</a>
                                      </label>
                                      <select name="idsindicalizado" required class="form-control input-sm">
                                          <option value="">--------</option>
                                          {loop="$fsc->sindicalizacion->all()"}
                                          <option value="{$value->idsindicato}" {if="$fsc->agente->idsindicato==$value->idsindicato"}selected{/if}>{$value->descripcion}</option>
                                          {/loop}
                                      </select>
                                   </div>
                                </div>
                         </fieldset>
                         <fieldset>
                            <legend>Datos Sociales:</legend>
                                <div class="col-sm-3">
                                   <div class="form-group">
                                      <label class="label label-sm label-default" for="codformacion">
                                          <a href="{$fsc->formacion->url()}">Formación:</a>
                                      </label>
                                      <select name="codformacion" required class="form-control input-sm">
                                          <option value="">--------</option>
                                          {loop="$fsc->formacion->all()"}
                                          <option value="{$value->codformacion}" {if="$fsc->agente->codformacion==$value->codformacion"}selected{/if}>{$value->nombre}</option>
                                          {/loop}
                                      </select>
                                   </div>
                                </div>
                                <div class="col-sm-4">
                                   <div class="form-group">
                                      <label class="label label-sm label-default" for="carrera">
                                          Carrera:
                                      </label>
                                      <input class="form-control input-sm" type="text" name="carrera" value="{$fsc->agente->carrera}" autocomplete="off"/>
                                   </div>
                                </div>
                                <div class="col-sm-5">
                                   <div class="form-group">
                                      <label class="label label-sm label-default" for="centroestudios">
                                          Centro de estudios:
                                      </label>
                                      <input class="form-control input-sm" type="text" name="centroestudios" value="{$fsc->agente->centroestudios}" autocomplete="off"/>
                                   </div>
                                </div>
                                <div class="col-sm-3">
                                   <div class="form-group">
                                      <label class="label label-sm label-default">
                                          <a href="{$fsc->seguridadsocial->url()}">Seguridad Social:</a>
                                      </label>
                                      <select name="codseguridadsocial" required class="form-control input-sm">
                                          <option value="">--------</option>
                                          {loop="$fsc->seguridadsocial->all()"}
                                          <option value="{$value->codseguridadsocial}" {if="$fsc->agente->codseguridadsocial==$value->codseguridadsocial"}selected{/if}>{$value->nombre}</option>
                                          {/loop}
                                      </select>
                                   </div>
                                </div>
                                <div class="col-sm-3">
                                   <div class="form-group">
                                      <label class="label label-sm label-default">
                                          Nº Seguridad Social:
                                      </label>
                                      <input class="form-control input-sm" type="text" name="seg_social" value="{$fsc->agente->seg_social}" autocomplete="off"/>
                                   </div>
                                </div>
                                <div class="col-sm-3">
                                   <div class="form-group">
                                      <label class="label label-sm label-default">
                                          <a href="{$fsc->bancos->url()}">Banco:</a>
                                      </label>
                                      <select name="codbanco" required class="form-control input-sm">
                                          <option value="">--------</option>
                                          {loop="$fsc->bancos->all_activos()"}
                                          <option value="{$value->codbanco}" {if="$fsc->agente->codbanco==$value->codbanco"}selected{/if}>{$value->nombre}</option>
                                          {/loop}
                                      </select>
                                   </div>
                                </div>
                                <div class="col-sm-3">
                                   <div class="form-group">
                                      <label class="label label-sm label-default">
                                          Cuenta Bancaria:
                                      </label>
                                      <input class="form-control input-sm" type="text" name="cuenta_banco" value="{$fsc->agente->cuenta_banco}" autocomplete="off"/>
                                   </div>
                                </div>
                                <div class="col-sm-2">
                                   <div class="form-group">
                                      <label class="label label-sm label-default">
                                          Dependientes:
                                      </label>
                                      <div class="input-group">
                                          <span class="input-group-addon input-sm"><span class="fa fa-group"></span></span>
                                          <input class="form-control input-sm" type="number" name="dependientes" value="{$fsc->agente->dependientes}" autocomplete="off"/>
                                      </div>
                                   </div>
                                </div>
                            </fieldset>
                            <fieldset>
                            <legend>Datos adicionales:</legend>
                                <div class="col-sm-2">
                                   <div class="form-group">
                                      <label class="label label-sm label-default">
                                          Comisión:
                                      </label>
                                      <div class="input-group">
                                         <span class="input-group-addon input-sm">%</span>
                                         <input class="form-control input-sm" type="text" name="porcomision" value="{$fsc->agente->porcomision}" autocomplete="off"/>
                                      </div>
                                   </div>
                                </div>
                                <div class="col-sm-2">
                                   <div class="form-group">
                                      <label class="label label-sm label-default">Tiempo de Contrato:</label>
                                      <div class="input-group">
                                         <span class="input-group-addon input-sm"><span class="fa fa-calendar"></span></span>
                                         <input class="form-control input-sm" type="text" name="porcomision" value="{$fsc->agente->porcomision}" autocomplete="off"/>
                                      </div>
                                   </div>
                                </div>
                                
                          </fieldset>
                      </div>
                      <div class="panel-footer" style="text-align: right;">
                         <button class="btn btn-sm btn-primary" type="submit">
                            <span class="glyphicon glyphicon-floppy-disk"></span> &nbsp; Guardar
                         </button>
                      </div>
                   </div>
                </form>
            </div>
         {loop="$fsc->extensions"}
            {if="$value->type=='tab'"}
            <div role="tabpanel" class="tab-pane" id="ext_{$key}">
               <iframe src="index.php?page={$value->from}{$value->params}&cod={$fsc->agente->codagente}" width="100%" height="2000" frameborder="0"></iframe>
            </div>
            {/if}
         {/loop}
         </div>
       </div>
   </div>
</div>
{include="contenido/nuevo_empleado"}
{else}
<div class="thumbnail">
   <img src="{#FS_PATH#}view/img/fuuu_face.png" alt="fuuuuu"/>
</div>
{/if}

{include="footer"}